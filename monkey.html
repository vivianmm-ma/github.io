<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Changed the title for this specific page -->
    <title>Quest Log: Our Flow & Teamwork - CindnessKult</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start 2P&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <!-- Tailwind CSS CDN for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* CindnessKult Base Styling from headercode.docx */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #2c2c44; /* Dark blue/purple background for retro feel */
            color: #e6e6fa; /* Light lavender text */
            margin: 0;
            padding: 20px;
        }
        .main-container {
            width: 100%;
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .site-header {
            border: 4px solid #9370db; /* Medium purple border */
            background-color: #483d8b; /* Darker purple for header */
            padding: 1rem;
            text-align: center;
            margin-bottom: 2.5rem;
            box-shadow: 8px 8px 0px #6366f1; /* Stronger shadow for retro depth */
            border-radius: 0.75rem; /* Rounded corners for the header */
            font-family: 'Press Start 2P', cursive; /* Apply retro font */
        }
        .site-header h1 {
            color: #98c379; /* Green for main title */
            font-size: 2.5rem;
            margin: 0;
            text-shadow: -2px 2px 0 #304694; /* Pixel-like shadow */
        }
        .site-header p {
            font-size: 0.75rem;
            color: #e8e6ff; /* Lighter text for subtitle */
            margin-top: 0.5rem;
        }
        
        .sticker-link {
            display: block;
            width: 200px;
            height: 200px;
            margin: 0 auto 2rem auto;
            text-decoration: none;
        }
        .sticker-container {
            width: 100%;
            height: 100%;
            background-color: #e8e6ff;
            border: 4px solid #98c379; /* Green border */
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            box-shadow: 0 5px 10px rgba(0,0,0,0.2), 0 0 0 5px #fff;
            position: relative;
            transition: transform 0.2s ease;
        }
        .sticker-link:hover .sticker-container {
            transform: scale(1.05);
        }
        .yin-yang {
            position: relative;
            width: 60px;
            height: 60px;
            border-color: #304694;
            border-style: solid;
            border-width: 2px;
            border-radius: 50%;
            background: linear-gradient(to bottom, #556fc8 50%, #e8e6ff 50%);
            flex-shrink: 0;
            margin-top: -20px;
        }
        .yin-yang::before,
        .yin-yang::after {
            content: '';
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 15px;
            height: 15px;
            border-radius: 50%;
            border: 1px solid #304694;
        }
        .yin-yang::before {
            top: 7.5px;
            background-color: #e8e6ff;
        }
        .yin-yang::after {
            bottom: 7.5px;
            background-color: #556fc8;
        }
        .curved-text-container {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
        }
        .char {
            position: absolute;
            height: 100px;
            transform-origin: bottom center;
            left: 50%;
            top: 0;
            color: #304694;
            font-size: 0.8rem;
            font-family: 'Press Start 2P', cursive;
            text-shadow: -1px 1px 0 #98c379;
        }
        .bottom-text {
            color: #322277;
            font-size: 0.75rem;
            font-family: 'Press Start 2P', cursive;
            margin-top: 0.5rem;
            transform: rotate(-5deg);
        }

        /* Retro Game Checklist Specific Styles */
        .game-container {
            max-width: 960px;
            margin: 2rem auto;
            padding: 1.5rem;
            background-color: #1a1a2e; /* Darker background for game area */
            border-radius: 1rem;
            box-shadow: 10px 10px 0px #0f0f1c; /* Deep shadow for 3D effect */
            border: 4px solid #6366f1; /* Game-like border */
            font-family: 'Press Start 2P', cursive; /* Apply retro font */
            color: #98c379; /* Green text for content */
            text-shadow: -1px 1px 0 #304694; /* Pixel-like shadow for text */
        }
        .game-title {
            font-size: 2.25rem;
            color: #e8e6ff; /* Light purple for main title */
            text-align: center;
            margin-bottom: 1.5rem;
            text-shadow: -2px 2px 0 #6366f1; /* Stronger pixel shadow */
        }
        .game-subtitle {
            font-size: 0.85rem;
            color: #bebebe;
            text-align: center;
            margin-bottom: 2rem;
        }
        .game-panel {
            background-color: #304694; /* Dark blue for panel background */
            border: 4px solid #e8e6ff; /* Light border */
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 6px 6px 0px #556fc8; /* Panel shadow */
        }
        .panel-title {
            font-size: 1.5rem;
            color: #98c379; /* Green for panel titles */
            border-bottom: 3px solid #6366f1; /* Bold border under title */
            padding-bottom: 0.75rem;
            margin-bottom: 1.5rem;
            text-shadow: -1px 1px 0 #e8e6ff; /* Pixel shadow */
        }
        .checkbox-item {
            display: flex;
            align-items: center; /* Align items vertically */
            margin-bottom: 1rem;
            padding: 0.75rem;
            background-color: #483d8b; /* Item background */
            border-radius: 0.25rem;
            border: 2px solid #6366f1; /* Item border */
            box-shadow: 2px 2px 0px #322277; /* Item shadow */
            transition: background-color 0.1s ease;
        }
        .checkbox-item:last-child {
            margin-bottom: 0;
        }
        .checkbox-item input[type="checkbox"] {
            appearance: none; /* Hide default checkbox */
            width: 1.5rem;
            height: 1.5rem;
            border: 3px solid #e8e6ff; /* White border for custom checkbox */
            background-color: #1a1a2e; /* Dark inner color */
            margin-right: 1rem;
            cursor: pointer;
            position: relative;
            flex-shrink: 0;
            border-radius: 0.125rem; /* Slightly rounded corners for checkbox */
        }
        .checkbox-item input[type="checkbox"]:checked {
            background-color: #98c379; /* Green when checked */
            border-color: #304694; /* Dark border when checked */
        }
        .checkbox-item input[type="checkbox"]:checked::after {
            content: '✓'; /* Checkmark symbol */
            font-size: 1.2rem;
            color: #2c2c44; /* Dark text for checkmark */
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-family: 'Press Start 2P', cursive;
            line-height: 1;
        }
        .checkbox-item label {
            font-size: 0.9rem; /* Smaller font for list items */
            color: #e8e6ff; /* Light purple for label text */
            flex-grow: 1;
        }
        .time-estimate {
            font-size: 0.75rem;
            color: #dcdcdc; /* Lighter color for time */
            margin-left: auto; /* Push to the right */
            white-space: nowrap;
        }
        
        /* Progress Bar Styling */
        .progress-bar-area {
            text-align: center;
            margin-bottom: 2.5rem;
            background-color: #304694;
            border: 4px solid #e8e6ff;
            border-radius: 0.5rem;
            padding: 1rem;
            box-shadow: 6px 6px 0px #556fc8;
        }
        .progress-bar-label {
            font-size: 1.1rem;
            color: #98c379;
            margin-bottom: 0.75rem;
            text-shadow: -1px 1px 0 #e8e6ff;
        }
        .progress-bar-container {
            width: 90%;
            height: 30px;
            background-color: #1a1a2e; /* Empty bar color */
            border: 2px solid #e8e6ff; /* Bar border */
            margin: 0 auto;
            border-radius: 0.25rem;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 0 5px rgba(0,0,0,0.5); /* Inner shadow for depth */
        }
        .progress-bar-fill {
            height: 100%;
            width: 0%; /* Start at 0% for dynamic update */
            background-color: #98c379; /* Green fill color */
            transition: width 0.5s ease-in-out; /* Smooth transition */
            box-shadow: inset 0 0 5px rgba(0,0,0,0.5); /* Inner shadow for fill */
            position: relative;
        }
        .progress-bar-percentage {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #2c2c44; /* Dark text on green bar */
            font-size: 0.75rem;
            font-family: 'Press Start 2P', cursive;
            white-space: nowrap;
        }

        /* Mission Control / Timer Styling */
        .mission-control-panel {
            background-color: #304694;
            border: 4px solid #e8e6ff;
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 6px 6px 0px #556fc8;
            text-align: center; /* Center content */
        }
        .mission-control-title {
            font-size: 1.5rem;
            color: #98c379;
            border-bottom: 3px solid #6366f1;
            padding-bottom: 0.75rem;
            margin-bottom: 1.5rem;
            text-shadow: -1px 1px 0 #e8e6ff;
        }
        .timer-display {
            background-color: #1a1a2e;
            border: 2px solid #e8e6ff;
            border-radius: 0.25rem;
            padding: 0.75rem;
            margin: 1rem auto;
            width: fit-content;
            font-size: 1.5rem;
            color: #98c379;
            text-shadow: -1px 1px 0 #304694;
        }
        .action-button {
            display: inline-block;
            background-color: #6366f1;
            color: #e8e6ff;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            border: 2px solid #e8e6ff;
            box-shadow: 4px 4px 0px #483d8b;
            cursor: pointer;
            text-decoration: none;
            font-size: 1rem;
            margin: 0.5rem;
            transition: background-color 0.1s ease, box-shadow 0.1s ease;
        }
        .action-button:hover {
            background-color: #556fc8;
            box-shadow: 2px 2px 0px #322277;
        }
        .note-text {
            font-size: 0.75rem;
            color: #bebebe;
            margin-top: 1rem;
        }

        /* Content Editable Styling */
        .editable-list-area {
            background-color: #483d8b; /* Item background */
            border-radius: 0.25rem;
            border: 2px solid #6366f1; /* Item border */
            box-shadow: 2px 2px 0px #322277; /* Item shadow */
            padding: 1rem;
            min-height: 100px; /* Ensure visible height */
            color: #e8e6ff; /* Light purple for text */
            text-align: left; /* Align text left within editable area */
        }
        .editable-list-area:empty::before {
            content: attr(data-placeholder);
            color: #bebebe; /* Placeholder text color */
        }

        /* Tally Board Specific Styles */
        .tally-board {
            background-color: #1a1a2e;
            border: 3px solid #98c379;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-top: 1rem;
            box-shadow: 4px 4px 0px #304694;
            text-align: left;
        }
        .tally-item {
            font-size: 0.9rem;
            color: #e8e6ff;
            margin-bottom: 0.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .tally-count {
            background-color: #6366f1;
            color: #e8e6ff;
            padding: 0.2rem 0.5rem;
            border-radius: 0.2rem;
            border: 1px solid #e8e6ff;
            min-width: 2.5rem;
            text-align: center;
            font-size: 0.8rem;
            box-shadow: 1px 1px 0px #322277;
        }
        .tally-explanation {
            font-size: 0.7rem;
            color: #bebebe;
            margin-top: 0.5rem;
            line-height: 1.4;
        }
        .tally-button {
            background-color: #556fc8;
            color: #e8e6ff;
            padding: 0.1rem 0.4rem;
            border-radius: 0.2rem;
            border: 1px solid #e8e6ff;
            cursor: pointer;
            font-size: 0.7rem;
            margin-left: 0.5rem;
            box-shadow: 1px 1px 0px #304694;
            transition: background-color 0.1s ease, box-shadow 0.1s ease;
        }
        .tally-button:hover {
            background-color: #483d8b;
            box-shadow: 0.5px 0.5px 0px #223a6b;
        }
        .tally-reset-button {
            background-color: #e74c3c; /* Red for reset */
            color: #fff;
            padding: 0.4rem 0.8rem;
            border-radius: 0.5rem;
            border: 2px solid #c0392b;
            box-shadow: 4px 4px 0px #8f2d22;
            cursor: pointer;
            font-size: 0.8rem;
            margin-top: 1rem;
        }
        .tally-reset-button:hover {
            background-color: #c0392b;
            box-shadow: 2px 2px 0px #6d1e18;
        }

        /* Custom Task Input Area */
        .custom-task-input-group {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            align-items: center;
        }
        .custom-task-input {
            flex-grow: 1;
            background-color: #1a1a2e;
            border: 2px solid #e8e6ff;
            border-radius: 0.25rem;
            padding: 0.75rem;
            color: #e8e6ff;
            font-family: 'Press Start 2P', cursive;
            font-size: 0.8rem;
        }
        .custom-task-input::placeholder {
            color: #bebebe;
        }
        .add-button {
            background-color: #98c379;
            color: #2c2c44;
            padding: 0.75rem 1.25rem;
            border-radius: 0.5rem;
            border: 2px solid #304694;
            box-shadow: 4px 4px 0px #556fc8;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background-color 0.1s ease, box-shadow 0.1s ease;
            white-space: nowrap;
        }
        .add-button:hover {
            background-color: #79a164;
            box-shadow: 2px 2px 0px #223a6b;
        }
        .delete-button {
            background-color: #e74c3c; /* Red color for delete */
            color: #fff;
            padding: 0.2rem 0.5rem;
            border-radius: 0.25rem;
            border: 1px solid #c0392b;
            cursor: pointer;
            font-size: 0.7rem;
            margin-left: 0.5rem;
            box-shadow: 1px 1px 0px #8f2d22;
            transition: background-color 0.1s ease, box-shadow 0.1s ease;
            white-space: nowrap;
            flex-shrink: 0;
        }
        .delete-button:hover {
            background-color: #c0392b;
            box-shadow: 0.5px 0.5px 0px #6d1e18;
        }
        .custom-time-input {
            background-color: #1a1a2e;
            border: 1px solid #e8e6ff;
            border-radius: 0.15rem;
            padding: 0.2rem 0.4rem;
            color: #e8e6ff;
            font-family: 'Inter', sans-serif; /* Use Inter for smaller text */
            font-size: 0.7rem;
            width: 70px; /* Fixed width for time input */
            margin-left: 0.5rem;
            flex-shrink: 0;
        }
        .custom-time-input::placeholder {
            color: #bebebe;
        }

        /* Styling for the embedded Google Sheet container */
        .embedded-sheet-container {
            width: 100%;
            max-width: 960px;
            margin: 2rem auto;
            background-color: #1a1a2e; /* Darker background for game area */
            border-radius: 1rem;
            box-shadow: 10px 10px 0px #0f0f1c; /* Deep shadow for 3D effect */
            border: 4px solid #6366f1; /* Game-like border */
            overflow: hidden; /* Ensures iframe respects border-radius */
        }
        .embedded-sheet-container iframe {
            width: 100%;
            height: 800px; /* Adjust height as needed */
            border: none; /* Remove iframe default border */
        }
    </style>
</head>
<body>
    <div class="main-container">
        
        <!-- ===== START OF REUSABLE HEADER CODE ===== -->
        <a href="https://www.cindnesskult.com" class="sticker-link">
            <div class="sticker-container">
                <div class="curved-text-container">
                    <!-- JS will populate this -->
                </div>
                <div class="yin-yang"></div>
                <p class="bottom-text">not just right</p>
            </div>
        </a>
        
        <header class="site-header">
            <h1>Cindness KULT</h1>
            <p>* ✧ The answer is always kindness. (not a cult btw) ✧ *</p>
        </header>
        <!-- ===== END OF REUSABLE HEADER CODE ===== -->

        <!-- Your Checklist Content Starts Here -->
        <div class="game-container">
            <h1 class="game-title">QUEST LOG</h1>
            <p class="game-subtitle">Track your progress, brave adventurers!</p>

            <!-- Mission Control Panel (Timer, Next Step) - MOVED TO TOP -->
            <div class="mission-control-panel">
                <h2 class="panel-title">Mission Control</h2>
                <div class="timer-display" id="stopwatchDisplay">
                    Stopwatch: 00:00:00
                </div>
                <p class="text-sm text-gray-300" id="currentTaskDisplay">Current Task: Ready to Start</p>
                <div class="mt-4">
                    <a href="#" class="action-button" id="startStopButton">▶️ START TIMER</a>
                    <a href="#" class="action-button" id="nextButton">⏭️ RESET TIMER</a>
                </div>
                <p class="note-text" id="timerNote">Click START TIMER to begin your session.</p>
            </div>

            <!-- Progress Bar (still based on local interactive elements) -->
            <div class="progress-bar-area">
                <div class="progress-bar-label">Overall Progress (Local)</div>
                <div class="progress-bar-container">
                    <div class="progress-bar-fill">
                        <span class="progress-bar-percentage">0% Complete</span>
                    </div>
                </div>
                <p class="note-text">This progress bar tracks your Personal Daily Quests and Tally Boards.</p>
            </div>

            <!-- Daily Quests - EMBEDDED GOOGLE SHEET -->
            <div class="game-panel">
                <h2 class="panel-title">Daily Quests (Shared via Google Sheet)</h2>
                <p class="text-sm text-gray-300 mb-4">
                    This is your main shared daily checklist.
                    **Monkey's Days Off:** Monday, Tuesday, Wednesday<br>
                    **Bonobo's Days Off:** Saturday, Sunday<br>
                    **Friday:** Bonobo usually takes lead on evening tasks.
                </p>
                <div class="embedded-sheet-container">
                    <!-- GOOGLE SHEETS EMBED CODE -->
                    <iframe src="https://docs.google.com/spreadsheets/d/1hD7eBIcoGugcWm6kzptmcT98_qUvjKyDZqehTIxBi20/pubhtml?gid=0&amp;single=true&amp;widget=true&amp;headers=false" width="100%" height="800"></iframe>
                </div>
                <p class="note-text mt-4">Changes in this section are saved automatically by Google Sheets and sync across devices.</p>
            </div>

            <!-- Personal Daily Quests (Local Persistence) -->
            <div class="game-panel">
                <h2 class="panel-title">Personal Daily Quests <span class="text-xs text-gray-400 block mt-1">(Your custom tasks, saved on this device!)</span></h2>
                <div class="custom-task-input-group">
                    <input type="text" id="newCustomTaskInput" class="custom-task-input" placeholder="Enter new custom quest...">
                    <button id="addCustomTaskButton" class="add-button">ADD QUEST</button>
                </div>
                <ul id="customTaskList">
                    <!-- Custom tasks will be loaded/added here -->
                </ul>
                <p class="note-text mt-4">Your custom quests will save automatically on this device!</p>
            </div>

            <!-- Kindness Tally Board (Local Persistence) -->
            <div class="game-panel">
                <h2 class="panel-title">Kindness Tally Board</h2>
                <p class="note-text mb-4">Track your kindness stats! (Saved on this device)</p>
                <div class="tally-board">
                    <div class="tally-item">
                        <span>Kind to Monkey:</span>
                        <span class="tally-count" id="kindToMonkeyCount">0</span>
                        <button class="tally-button" id="kindToMonkeyAdd">+</button>
                    </div>
                    <div class="tally-item">
                        <span>Kind to Bonobo:</span>
                        <span class="tally-count" id="kindToBonoboCount">0</span>
                        <button class="tally-button" id="kindToBonoboAdd">+</button>
                    </div>
                    <div class="tally-item">
                        <span>Kind to Self (Bonobo):</span>
                        <span class="tally-count" id="kindToSelfBonoboCount">0</span>
                        <button class="tally-button" id="kindToSelfBonoboAdd">+</button>
                    </div>
                    <div class="tally-item">
                        <span>Kind to Self (Monkey):</span>
                        <span class="tally-count" id="kindToSelfMonkeyCount">0</span>
                        <button class="tally-button" id="kindToSelfMonkeyAdd">+</button>
                    </div>
                    <div class="tally-item">
                        <span>Kindness Level:</span>
                        <span class="tally-count" id="kindnessLevelCount">0</span>
                        <button class="tally-button" id="kindnessLevelAdd">+</button>
                    </div>
                    <p class="tally-explanation mt-4">Increase your kindness level by being intentional and thoughtful in your actions towards yourself and each other. Remember, the answer is always kindness! ✨</p>
                    <div class="mt-4 text-center">
                        <button class="tally-reset-button" id="resetKindnessTally">RESET KINDNESS TALLY</button>
                    </div>
                </div>
            </div>

            <!-- Question Tally Board (Local Persistence) -->
            <div class="game-panel">
                <h2 class="panel-title">Monkey's Question Tally</h2>
                <p class="note-text mb-4">Tracks Monkey's question limit. (Saved on this device)</p>
                <div class="tally-board">
                    <div class="tally-item">
                        <span>Questions Asked Today:</span>
                        <span class="tally-count" id="questionsAskedCount">0</span>
                        <button class="tally-button" id="questionsAskedAdd">+</button>
                    </div>
                    <p class="tally-explanation mt-4">Monkey has a maximum of **10 minutes** or **two separate instances** per day for repetitive/reassurance-seeking questions. Use the stopwatch above to help track time if needed.</p>
                    <div class="mt-4 text-center">
                        <button class="tally-reset-button" id="resetQuestionsTally">RESET QUESTIONS TALLY</button>
                    </div>
                </div>
            </div>

            {/* Recurring Chore Checklist - Static HTML */}
            <div class="game-panel">
                <h2 class="panel-title">Weekly & Bi-Weekly Quests</h2>
                <ul>
                    <li class="checkbox-item">
                        <label>Pick up dog poop (daily/as needed)</label>
                    </li>
                    <li class="checkbox-item">
                        <label>Clean toilet & sink (weekly)</label>
                    </li>
                    <li class="checkbox-item">
                        <label>Ensure trash is not overflowing & take it out (as needed)</label>
                    </li>
                    <li class="checkbox-item">
                        <label>Recycling (weekly)</label>
                    </li>
                    <li class="checkbox-item">
                        <label>Clean the shower (monthly/bi-weekly)</label>
                    </li>
                    <li class="checkbox-item">
                        <label>Walk the dog (at least twice a week - **schedule these!**)</label>
                    </li>
                    <li class="checkbox-item">
                        <label>Goal: Midnight walk together (every other day, 30 min long)</label>
                    </li>
                </ul>
            </div>

            {/* Health & Coordination Tasks - Static HTML */}
            <div class="game-panel">
                <h2 class="panel-title">Party Management & Logistics</h2>
                <ul>
                    <li class="checkbox-item">
                        <label>**Medication Alarm (9 AM):** Take meds one hour before wake-up (or 9:30 AM initially)</label>
                    </li>
                    <li class="checkbox-item">
                        <label>**Monkey: Bedroom Clear by 12:20 PM** (for Bonobo's work/therapy at 12:30/1 PM)</label>
                    </li>
                    <li class="checkbox-item">
                        <label>**Monkey: Prepare outfits** for next day/evening outside the bedroom</label>
                    </li>
                    <li class="checkbox-item">
                        <label>**Monkey: ADHD Meds:** Find prescriber & make appointment within 10-20 days (Bonobo provides 20 pills)</label>
                    </li>
                    <li class="checkbox-item">
                        <label>**Monkey: Share Doctor Appointment Time** with Bonobo</label>
                    </li>
                    <li class="checkbox-item">
                        <label>Collaborate on completing FAFSA</label>
                    </li>
                    <li class="checkbox-item">
                        <label>Properly plan meals together</label>
                    </li>
                    <li class="checkbox-item">
                        <label>**By End of Month:** Buy tablet for shared calendar (fridge/sync)</label>
                    </li>
                </ul>
            </div>

            {/* Communication Tools - Static HTML */}
            <div class="game-panel">
                <h2 class="panel-title">Communication Tools: Quest Diplomacy</h2>
                <div class="mb-4">
                    <h3 class="text-xl font-semibold mb-2" style="color: #e8e6ff;">Safe Words:</h3>
                    <ul class="list-disc list-inside text-sm text-gray-300 pl-4">
                        <li>**For OCD Reassurance Seeking (Bonobo to Monkey):** When Bonobo needs to pause a conversation that's becoming overwhelming or repetitive, use a pre-agreed safe word like "**PAUSE**," "**RED LIGHT**," or "**RETURN LATER**." This signals a need for a break and promises a revisit.</li>
                        <li>**For Procrastination (Both):** When either person notices the other (or themselves) procrastinating on tasks, use a gentle cue like "**ADAM STEWART**" or "**BYRON**." This is a non-judgmental nudge to re-focus.</li>
                    </ul>
                </div>
                <div class="mb-4">
                    <h3 class="text-xl font-semibold mb-2" style="color: #e8e6ff;">Question Limit Protocol:</h3>
                    <p class="text-sm text-gray-300 pl-4">
                        To manage reassurance-seeking conversations and preserve time, Monkey can ask questions for a maximum of **10 minutes per day**, or in **two separate instances per day** (e.g., two 5-minute sessions). This helps ensure both of you can get your tasks done and regulate. This also applies to the use of a "tally board" if desired.
                    </p>
                </div>
            </div>

            <!-- Groceries & Other Topics - Content Editable (No Persistence) -->
            <div class="game-panel">
                <h2 class="panel-title">Inventory & Party Chat</h2>
                <p class="note-text mb-4">You can type directly into these fields to update them! (Changes will NOT be saved after closing the page, as there is no backend.)</p>
                <div class="mb-4">
                    <h3 class="text-xl font-semibold mb-2" style="color: #e8e6ff;">Items for Our Cart:</h3>
                    <div class="editable-list-area" contenteditable="true" data-placeholder="e.g., Milk, Eggs, Bread&#10;Add more items here..."></div>
                </div>
                <div class="mb-4">
                    <h3 class="text-xl font-semibold mb-2" style="color: #e8e6ff;">Topics for Group Discussion (When We Have XP):</h3>
                    <div class="editable-list-area" contenteditable="true" data-placeholder="e.g., Weekend plans&#10;Monthly budget review&#10;Add more discussion topics here..."></div>
                </div>
                <div>
                    <h3 class="text-xl font-semibold mb-2" style="color: #e8e6ff;">Items to Acquire (Store Run):</h3>
                    <div class="editable-list-area" contenteditable="true" data-placeholder="e.g., Tablet for shared calendar&#10;New dog toy&#10;Add more items to buy here..."></div>
                </div>
            </div>
        </div>
        <!-- Your Checklist Content Ends Here -->

    </div>

    <script>
        // === Stopwatch Functionality (Local Persistence) ===
        let timer;
        let isRunning = false;
        let seconds = 0;
        let minutes = 0;
        let hours = 0;

        const stopwatchDisplay = document.getElementById('stopwatchDisplay');
        const startStopButton = document.getElementById('startStopButton');
        const nextButton = document.getElementById('nextButton'); 
        const currentTaskDisplay = document.getElementById('currentTaskDisplay');
        const timerNote = document.getElementById('timerNote');

        function formatTime(h, m, s) {
            const pad = (num) => String(num).padStart(2, '0');
            return `Stopwatch: ${pad(h)}:${pad(m)}:${pad(s)}`;
        }

        function updateStopwatchDisplay() {
            stopwatchDisplay.textContent = formatTime(hours, minutes, seconds);
        }

        function startStopwatch() {
            if (!isRunning) {
                isRunning = true;
                timer = setInterval(() => {
                    seconds++;
                    if (seconds === 60) {
                        seconds = 0;
                        minutes++;
                        if (minutes === 60) {
                            minutes = 0;
                            hours++;
                        }
                    }
                    updateStopwatchDisplay();
                    saveStopwatchState(); // Save state every second
                }, 1000);
                startStopButton.textContent = '⏸️ PAUSE TIMER';
                currentTaskDisplay.textContent = 'Current Task: In Progress...'; 
                timerNote.textContent = 'Timer is running!';
            } else {
                pauseStopwatch();
            }
        }

        function pauseStopwatch() {
            if (isRunning) {
                clearInterval(timer);
                isRunning = false;
                startStopButton.textContent = '▶️ RESUME TIMER';
                timerNote.textContent = 'Timer paused.';
            }
        }

        function resetStopwatch() {
            clearInterval(timer);
            isRunning = false;
            seconds = 0;
            minutes = 0;
            hours = 0;
            updateStopwatchDisplay();
            startStopButton.textContent = '▶️ START TIMER';
            currentTaskDisplay.textContent = 'Current Task: Ready to Start';
            timerNote.textContent = 'Timer reset.';
            saveStopwatchState(); // Save reset state
        }

        function saveStopwatchState() {
            localStorage.setItem('stopwatchState', JSON.stringify({ hours, minutes, seconds, isRunning }));
        }

        function loadStopwatchState() {
            const storedState = localStorage.getItem('stopwatchState');
            if (storedState) {
                const state = JSON.parse(storedState);
                hours = state.hours;
                minutes = state.minutes;
                seconds = state.seconds;
                isRunning = state.isRunning; // Load isRunning state
                updateStopwatchDisplay();
                if (isRunning) {
                    startStopwatch(); // Resume if it was running
                } else {
                    startStopButton.textContent = '▶️ START TIMER'; // Ensure button text is correct if paused
                    currentTaskDisplay.textContent = 'Current Task: Ready to Start';
                    timerNote.textContent = 'Click START TIMER to begin your session.';
                }
            }
        }

        // Event Listeners for Stopwatch Buttons
        startStopButton.addEventListener('click', (e) => {
            e.preventDefault(); 
            startStopwatch();
        });

        nextButton.addEventListener('click', (e) => {
            e.preventDefault(); 
            resetStopwatch(); 
        });

        // === Progress Bar Functionality (Local) ===
        // This progress bar now only tracks custom tasks and tally boards.
        function updateProgressBar() {
            const customTaskCheckboxes = document.querySelectorAll('#customTaskList input[type="checkbox"]');
            const tallyElements = document.querySelectorAll('.tally-count');

            let checkedCustomTasks = 0;
            customTaskCheckboxes.forEach(checkbox => {
                if (checkbox.checked) {
                    checkedCustomTasks++;
                }
            });

            // For simplicity, progress bar will track custom tasks + a fixed number for tallies
            // as tallies don't have a 'checked' state. We can adjust this logic if needed.
            const totalTrackedItems = customTaskCheckboxes.length + tallyElements.length;
            const completedTrackedItems = checkedCustomTasks; // Only custom tasks contribute to 'completed' directly

            // A more meaningful progress bar might require defining "completion" for tallies
            // For now, it's primarily a visual for custom tasks.
            const percentage = totalTrackedItems > 0 ? (completedTrackedItems / totalTrackedItems) * 100 : 0;
            
            const progressBarFill = document.querySelector('.progress-bar-fill');
            const progressBarPercentageSpan = document.querySelector('.progress-bar-percentage');

            if (progressBarFill && progressBarPercentageSpan) {
                progressBarFill.style.width = `${percentage}%`;
                progressBarPercentageSpan.textContent = `${Math.round(percentage)}% Complete`;
            }
        }
        
        // === Custom Task List Functionality (Local Persistence) ===
        const newCustomTaskInput = document.getElementById('newCustomTaskInput');
        const addCustomTaskButton = document.getElementById('addCustomTaskButton');
        const customTaskList = document.getElementById('customTaskList');

        function saveCustomTasks() {
            const tasks = [];
            customTaskList.querySelectorAll('.checkbox-item').forEach(item => {
                const text = item.querySelector('label').textContent;
                const checked = item.querySelector('input[type="checkbox"]').checked;
                const time = item.querySelector('.custom-time-input').value;
                tasks.push({ text, checked, time });
            });
            localStorage.setItem('customQuests', JSON.stringify(tasks));
        }

        function loadCustomTasks() {
            const storedTasks = localStorage.getItem('customQuests');
            if (storedTasks) {
                const tasks = JSON.parse(storedTasks);
                tasks.forEach(task => addCustomTask(task.text, task.checked, task.time));
            }
        }

        function addCustomTask(taskText, isChecked = false, timeNote = '') {
            if (!taskText.trim()) return;

            const listItem = document.createElement('li');
            listItem.className = 'checkbox-item';

            const checkbox = document.createElement('input');
            checkbox.type = 'checkbox';
            checkbox.checked = isChecked;
            checkbox.addEventListener('change', () => {
                updateProgressBar();
                saveCustomTasks();
            });

            const label = document.createElement('label');
            label.textContent = taskText;

            const timeInput = document.createElement('input');
            timeInput.type = 'text';
            timeInput.className = 'custom-time-input';
            timeInput.placeholder = 'e.g., 15min';
            timeInput.value = timeNote;
            timeInput.addEventListener('input', saveCustomTasks);

            const deleteButton = document.createElement('button');
            deleteButton.textContent = 'DELETE';
            deleteButton.className = 'delete-button';
            deleteButton.addEventListener('click', () => {
                listItem.remove();
                updateProgressBar();
                saveCustomTasks();
            });

            listItem.appendChild(checkbox);
            listItem.appendChild(label);
            listItem.appendChild(timeInput);
            listItem.appendChild(deleteButton);
            customTaskList.appendChild(listItem);

            updateProgressBar();
        }

        addCustomTaskButton.addEventListener('click', () => {
            const task = newCustomTaskInput.value;
            addCustomTask(task);
            newCustomTaskInput.value = '';
            saveCustomTasks();
        });

        newCustomTaskInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                addCustomTaskButton.click();
            }
        });

        // === Tally Board Functionality (Local Persistence) ===

        // Kindness Tally Elements
        const kindnessLevelCount = document.getElementById('kindnessLevelCount');
        const kindToSelfBonoboCount = document.getElementById('kindToSelfBonoboCount');
        const kindToSelfMonkeyCount = document.getElementById('kindToSelfMonkeyCount');
        const kindToMonkeyCount = document.getElementById('kindToMonkeyCount');
        const kindToBonoboCount = document.getElementById('kindToBonoboCount');

        const kindnessLevelAdd = document.getElementById('kindnessLevelAdd');
        const kindToSelfBonoboAdd = document.getElementById('kindToSelfBonoboAdd');
        const kindToSelfMonkeyAdd = document.getElementById('kindToSelfMonkeyAdd');
        const kindToMonkeyAdd = document.getElementById('kindToMonkeyAdd');
        const kindToBonoboAdd = document.getElementById('kindToBonoboAdd');
        const resetKindnessTallyButton = document.getElementById('resetKindnessTally');

        // Monkey's Question Tally Elements
        const questionsAskedCount = document.getElementById('questionsAskedCount');
        const questionsAskedAdd = document.getElementById('questionsAskedAdd');
        const resetQuestionsTallyButton = document.getElementById('resetQuestionsTally');

        function saveTallyState() {
            const tallyState = {
                kindnessLevel: parseInt(kindnessLevelCount.textContent),
                kindToSelfBonobo: parseInt(kindToSelfBonoboCount.textContent),
                kindToSelfMonkey: parseInt(kindToSelfMonkeyCount.textContent),
                kindToMonkey: parseInt(kindToMonkeyCount.textContent),
                kindToBonobo: parseInt(kindToBonoboCount.textContent),
                questionsAsked: parseInt(questionsAskedCount.textContent)
            };
            localStorage.setItem('tallyBoardState', JSON.stringify(tallyState));
            updateProgressBar(); // Update progress bar after tally change
        }

        function loadTallyState() {
            const storedState = localStorage.getItem('tallyBoardState');
            if (storedState) {
                const state = JSON.parse(storedState);
                kindnessLevelCount.textContent = state.kindnessLevel || 0;
                kindToSelfBonoboCount.textContent = state.kindToSelfBonobo || 0;
                kindToSelfMonkeyCount.textContent = state.kindToSelfMonkey || 0;
                kindToMonkeyCount.textContent = state.kindToMonkey || 0;
                kindToBonoboCount.textContent = state.kindToBonobo || 0;
                questionsAskedCount.textContent = state.questionsAsked || 0;
            }
        }

        // Kindness Tally Incrementers
        kindnessLevelAdd.addEventListener('click', () => {
            kindnessLevelCount.textContent = parseInt(kindnessLevelCount.textContent) + 1;
            saveTallyState();
        });
        kindToSelfBonoboAdd.addEventListener('click', () => {
            kindToSelfBonoboCount.textContent = parseInt(kindToSelfBonoboCount.textContent) + 1;
            saveTallyState();
        });
        kindToSelfMonkeyAdd.addEventListener('click', () => {
            kindToSelfMonkeyCount.textContent = parseInt(kindToSelfMonkeyCount.textContent) + 1;
            saveTallyState();
        });
        kindToMonkeyAdd.addEventListener('click', () => {
            kindToMonkeyCount.textContent = parseInt(kindToMonkeyCount.textContent) + 1;
            saveTallyState();
        });
        kindToBonoboAdd.addEventListener('click', () => {
            kindToBonoboCount.textContent = parseInt(kindToBonoboCount.textContent) + 1;
            saveTallyState();
        });

        // Kindness Tally Reset
        resetKindnessTallyButton.addEventListener('click', () => {
            kindnessLevelCount.textContent = 0;
            kindToSelfBonoboCount.textContent = 0;
            kindToSelfMonkeyCount.textContent = 0;
            kindToMonkeyCount.textContent = 0;
            kindToBonoboCount.textContent = 0;
            saveTallyState();
        });

        // Monkey's Question Tally Incrementer
        questionsAskedAdd.addEventListener('click', () => {
            questionsAskedCount.textContent = parseInt(questionsAskedCount.textContent) + 1;
            saveTallyState();
        });

        // Monkey's Question Tally Reset
        resetQuestionsTallyButton.addEventListener('click', () => {
            questionsAskedCount.textContent = 0;
            saveTallyState();
        });

        // === Initial setup when the DOM is fully loaded ===
        document.addEventListener('DOMContentLoaded', () => {
            loadStopwatchState(); // Load stopwatch state
            loadCustomTasks(); // Load custom tasks
            loadTallyState(); // Load tally board states
            updateProgressBar(); // Update progress bar based on loaded states
        });
    </script>
</body>
</html>
